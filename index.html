<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>CMT Proficiency</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <script type="text/javascript" src="//www.google.com/jsapi"></script>
    <script type="text/javascript">
    google.load('visualization', '1', {packages: ['controls']});
google.setOnLoadCallback(drawChart);

function drawChart () {
    var data = new google.visualization.DataTable();
    data.addColumn('string', 'Year');
    data.addColumn('number', 'Achievement First');
    data.addColumn('number', 'Asian Studies');
    data.addColumn('number', 'Batchelder');
    data.addColumn('number', 'Betances');
    data.addColumn('number', 'Breakthrough II');
    data.addColumn('number', 'Breakthrough');
    data.addColumn('number', 'Burns');
    data.addColumn('number', 'Burr');
    data.addColumn('number', 'Capital Prep');
    data.addColumn('number', 'Clark');
    data.addColumn('number', 'Classical Magnet');
    data.addColumn('number', 'Global');
    data.addColumn('number', 'HMTCA');
    data.addColumn('number', 'Hooker');
    data.addColumn('number', 'Kennelly');
    data.addColumn('number', 'Kinsella');
    data.addColumn('number', 'McDonough');
    data.addColumn('number', 'MD Fox');
    data.addColumn('number', 'Milner');
    data.addColumn('number', 'ML King');
    data.addColumn('number', 'Montessori AF');
    data.addColumn('number', 'Moylan');
    data.addColumn('number', 'Naylor');
    data.addColumn('number', 'Noah Webster');
    data.addColumn('number', 'Parkville');
    data.addColumn('number', 'Rawson');
    data.addColumn('number', 'Sanchez');
    data.addColumn('number', 'SAND');
    data.addColumn('number', 'Simpson-Waverly');
    data.addColumn('number', 'Sports & Med');
    data.addColumn('number', 'STEM at AF');
    data.addColumn('number', 'West Middle');
    data.addColumn('number', 'Wish');
    data.addColumn('number', 'Fox MS');
    data.addColumn('number', 'Barnard Brown');
    data.addColumn('number', 'Twain');
    data.addColumn('number', 'Quirk');
    data.addColumn('number', 'Hartford Average');      
    data.addRows([
        ['2007',  0, 46.7, 55.8, 32.8, 0, 70.5, 33.2, 52.9, 72.1, 40.9, 76.6, 0, 79.5, 49.1, 59.3, 40.3, 39.9, 41.6, 22.8, 36.4, 0, 0, 55.3, 63, 61.2, 58.3, 37.4, 39.2, 48.7, 0, 66.4, 49.4, 50.9, 34.5, 35, 39.8, 31.2, 48.3],
        ['2008',  0, 49.1, 52.3, 34.5, 0, 73.7, 27.4, 45.1, 76, 34.5, 80.7, 0, 78.3, 62.5, 58.1, 51.4, 43.9, 45.5, 27.2, 44.6, 0, 0, 57.7, 68.6, 65.4, 58.8, 43.8, 38.2, 49.7, 0, 52.2, 53.2, 57.8, 40.6, 29.7, 40.4, 24, 50.1],
        ['2009',  61.3, 49.1, 53.9, 36.6, 0, 71.4, 31.5, 46.8, 81.7, 42.5, 78.6, 54.9, 79.9, 60.4, 63.3, 63.5, 43.2, 49.5, 27.6, 54.1, 0, 0, 57.8, 71.9, 72.3, 57.6, 44.4, 35.2, 59.1, 71.5, 62.1, 54.2, 63.3, 0, 30.3, 0, 31.5, 54.8],
        ['2010',  71.4, 48.1, 48.8, 43.1, 34.9, 76.6, 35.3, 59.7, 71, 44.2, 80.7, 59.6, 81.6, 58.3, 58, 71.5, 50.6, 50.9, 32.5, 53.9, 100, 0, 53.1, 78.4, 73.1, 54, 52, 49.3, 56.9, 73.3, 66.4, 51.2, 60.7, 0, 0, 0, 34.2, 57.7],
        ['2011',  76, 45.2, 56.5, 43.5, 59.5, 75.7, 34.1, 61.1, 70.1, 49.7, 78.7, 61, 80.3, 65.2, 54.7, 75.5, 41.2, 45.5, 31.9, 49.4, 88.4, 0, 53.6, 85.4, 74.9, 57.5, 59, 45.9, 52.5, 75.7, 80.2, 52.9, 53.5, 0, 0, 0, 0, 59.5],
        ['2012',  83, 47.2, 54.5, 76.5, 64.9, 80.8, 35.6, 57.6, 76.3, 47, 77.6, 56.5, 82.5, 71.1, 57.3, 80.7, 37.6, 49.7, 34.1, 53.3, 79.7, 57.3, 55.5, 88.5, 61.5, 56.3, 55.6, 50.7, 57.7, 82, 84, 62.8, 58, 0, 0, 0, 0, 62.4],
        ['2013',  81.5, 43.6, 51.3, 63, 67.7, 78.3, 29.5, 53.1, 71.7, 48.8, 78.8, 61.9, 80, 74.8, 59.9, 79.4, 37.4, 48.7, 34.3, 57.2, 78.3, 56.2, 53.7, 87.6, 59.3, 64.7, 56.6, 47.3, 51.5, 81, 85.5, 67.7, 48.8, 0, 0, 0, 0, 62.6]
    ]);

    var columnsTable = new google.visualization.DataTable();
    columnsTable.addColumn('number', 'colIndex');
    columnsTable.addColumn('string', 'colLabel');
    var initState= {selectedValues: []};
    // put the columns into this data table (skip column 0)
    for (var i = 1; i < data.getNumberOfColumns(); i++) {
        columnsTable.addRow([i, data.getColumnLabel(i)]);
        // you can comment out this next line if you want to have a default selection other than the whole list
        initState.selectedValues.push(data.getColumnLabel(i));
    }
    // you can set individual columns to be the default columns (instead of populating via the loop above) like this:
    // initState.selectedValues.push(data.getColumnLabel(4));
    
    var chart = new google.visualization.ChartWrapper({
        chartType: 'LineChart',
        containerId: 'chart_div',
        dataTable: data,
        options: {
            title: 'CMT: Percentage at Proficient',
            width: 600,
            height: 400
        }
    });
    
    var columnFilter = new google.visualization.ControlWrapper({
        controlType: 'CategoryFilter',
        containerId: 'colFilter_div',
        dataTable: columnsTable,
        options: {
            filterColumnLabel: 'colLabel',
            ui: {
                label: 'Columns',
                allowTyping: false,
                allowMultiple: true,
                allowNone: false,
                selectedValuesLayout: 'below'
            }
        },
        'state': {'selectedValues': ['Hartford Average']}
    });
    
    function setChartView () {
        var state = columnFilter.getState();
        var row;
        var view = {
            columns: [0]
        };
        for (var i = 0; i < state.selectedValues.length; i++) {
            row = columnsTable.getFilteredRows([{column: 1, value: state.selectedValues[i]}])[0];
            view.columns.push(columnsTable.getValue(row, 0));
        }
        // sort the indices into their original order
        view.columns.sort(function (a, b) {
            return (a - b);
        });
        chart.setView(view);
        chart.draw();
    }
    google.visualization.events.addListener(columnFilter, 'statechange', setChartView);
    
    setChartView();
    columnFilter.draw();
}
</script>
  </head>
  <body>

    <div id="colFilter_div"></div>
  <div id="chart_div"></div>
  <p>*Note that if percentage at proficiency is zero, the school was not in existence that year OR the school   does not contain that grade level.
  <div id="creativeCommons" style="text-align: center; width: 400px;">
    <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.en_US"><img alt="Creative     Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by-nc-sa/3.0/88x31.png" /></a><br   /><span xmlns:dct="http://purl.org/dc/terms/" href="http://purl.org/dc/dcmitype/InteractiveResource"         property="dct:title" rel="dct:type">Code to use a CategoryFilter as a column selector</span> by <span xmlns    :cc  ="http://creativecommons.org/ns#" property="cc:attributionName">Andrew Gallant</span> is licensed under   a <a   rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.en_US">Creative Commons     Attribution  -NonCommercial-ShareAlike 3.0 Unported License</a>.
  </div>
  </body>
</html>

